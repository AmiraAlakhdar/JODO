# JODO

----

The implementation of [Learning Joint 2D & 3D Diffusion Models for
Complete Molecule Generation](https://arxiv.org/abs/2305.12347).

We will release the complete code ASAP.

Represent molecules as 3D point cloud and 2D bonding graph:
<p align="left">
  <img src="assets/exp_geom_ver.png" width="800"/> 
</p>

The generative diffusion process:
<p align="left">
  <img src="assets/sampling_exp.png" width="1200"/>
</p>

----

Visualization of molecules generated by JODO trained on the GEOM-Drugs dataset:
<p align="left">
  <img src="assets/geom_vis_3_3d.png" width="1500"/>
</p>
<p align="left">
  <img src="assets/geom_vis_3_2d.png" width="1500"/>
</p>
<p align="left">
  <img src="assets/geom_vis_2_3d.png" width="1500"/>
</p>
<p align="left">
  <img src="assets/geom_vis_2_2d.png" width="1500"/>
</p>

Visualization of molecules generated by JODO trained on the QM9 dataset with explict hydrogen atoms:
<p align="left">
  <img src="assets/qm9_vis_5_3d.png" width="1500"/>
</p>
<p align="left">
  <img src="assets/qm9_vis_5_2d.png" width="1500"/>
</p>
<p align="left">
  <img src="assets/qm9_vis_4_3d.png" width="1500"/>
</p>
<p align="left">
  <img src="assets/qm9_vis_4_2d.png" width="1500"/>
</p>

----

## Dataset

The raw GEOM dataset is available at [here](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/JNGTDF).
Download `rdkit_folder.tar.gz` and unpack it.
Run `python build_geom_dataset.py --data_dir YOUR_DATA_PATH` to construct the GEOM-Drugs dataset. 

We recommend using our processed dataset files provided [here](https://zenodo.org/record/7966493#.ZG7inOxBxhF).

Download datasets:
```bash
# 718MB
wget https://zenodo.org/record/7966493/files/data.zip
unzip data.zip
```

[//]: # (The data folder structure is: )

## Checkpoint

Our checkpoints are provided [here](https://zenodo.org/record/7966935#.ZG7jcexBxhE).

Download checkpoints:
```bash
# Unconditional Generation: QM9, GEOM-Drugs (2.8GB)
wget https://zenodo.org/record/7966935/files/exp_uncond.zip
unzip exp_uncond.zip

# Conditional Generation: single quantum property on QM9 (3.1GB)
wget https://zenodo.org/record/7966935/files/exp_cond.zip 
unzip exp_cond.zip

# Conditional Generation: multi properties (1.6GB)
wget https://zenodo.org/record/7966935/files/exp_cond_multi.zip 
unzip exp_cond_multi.zip

# Molecular Graph Generation: ZINC250k, MOSES (3.9GB)
wget https://zenodo.org/record/7966935/files/exp_2d.zip 
unzip exp_2d.zip
```


## Unconditional Generation


## Conditional Generation


## Molecular Graph Generation


## Citation

```bibtex
@misc{huang2023learning,
      title={Learning Joint 2D & 3D Diffusion Models for Complete Molecule Generation}, 
      author={Han Huang and Leilei Sun and Bowen Du and Weifeng Lv},
      year={2023},
      eprint={2305.12347},
      archivePrefix={arXiv},
      primaryClass={q-bio.BM}
}

@article{huang2023conditional,
  title={Conditional Diffusion Based on Discrete Graph Structures for Molecular Graph Generation},
  author={Huang, Han and Sun, Leilei and Du, Bowen and Lv, Weifeng},
  journal={arXiv preprint arXiv:2301.00427},
  year={2023}
```






